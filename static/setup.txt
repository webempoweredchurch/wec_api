# Include our xml class
includeLibs.tx_wecapi_list= EXT:wec_api/class.tx_wecapi_list.php

plugin.tx_wecapi_list >
plugin.tx_wecapi_list = USER
plugin.tx_wecapi_list {

	userFunc = tx_wecapi_list->main
	
	templateFile = EXT:wec_api/res/rss2.tmpl
	
	xmlFormat = rss2
	
	#	Marker array representing all of the markers we have in our template
	channelArray {
		generator =
		gen_date =
		xmlns =
		channel_title = 
		channel_link = 
		channel_description =
		language =
		namespace_entries =
		copyright =
		last_build_date =
		docs =
		channel_generator =
		channel_category =
		managing_editor =
		webmaster =
		ttl =
	}
	
	itemArray {
		item_title =
		item_link =
		item_description =
		item_author =
		item_category =
		item_comments =
		item_enclosure =
		item_pubdate = 
		item_guid =
		item_source =
	}

	# a CASE cObject that will allow us to choose our rendering for each marker
	tag_rendering = CASE
	
	tag_rendering {
		
		# Key is assigned value of the marker name
		key = 
		
		generator = TEXT
		generator.value = {$constants.wecapi.xml.rss.generator}


		gen_date = TEXT
		gen_date.data = date: D, d M Y h.i.s T

		channel_title  = TEXT
		channel_title.value = {$constants.wec.xml.rss.channel_title}
		channel_title.wrap = <title>|</title>
		
		channel_link = TEXT
		channel_link {
			value = {$constants.wec.siteURL}
			dataWrap = <link>|</link>
			
			# You must specify this in your implementation
			typolink.parameter = 78
			typolink.returnLast = url
		}
		
		channel_description = TEXT
		channel_description {
			value = {$constants.wec.xml.rss.channel_descr}
			wrap = <description>|</description>

		}
		
		channel_category = TEXT
		channel_category.value = {$constants.wec.xml.rss.channel_category}
		channel_category.wrap =  <category>|</category>

		channel_generator = TEXT
		channel_generator.value = {$constants.wecapi.xml.rss.generator}
		channel_generator.wrap = <generator>|</generator>
	
		copyright = TEXT
		copyright.value = {$constants.wec.copyright}
		copyright.wrap = <copyright>|</copyright>
		
		# This should be a valid language code. See http://www.w3.org/TR/REC-html40/struct/dirlang.html#langcodes
		language = TEXT
		language.value = {$constants.wecapi.xml.rss.language}
		language.wrap = <language>|</language>
		
		# This should be the e-mail adddress for the responsible manager over all the articles 
		managing_editor = TEXT
		managing_editor.value = {$constants.wecapi.xml.rss.managing_editor}
		managing_editor.wrap = <managingEditor>|</managingEditor>
		
		webmaster = TEXT
		webmaster.value = {$constants.wec.adminEmail}
		webmaster.wrap = <webMaster>|</webMaster>
		
		ttl = 
		
		last_build_date = TEXT
		last_build_date.data = date: D, d M Y h.i.s 
		last_build_date.wrap = <lastBuildDate>|</lastBuildDate>
		
		docs = TEXT
		docs.value = {$constants.wecapi.xml.rss.docs}
		docs.wrap = <docs>|</docs>

		item_title = TEXT
		item_title.wrap = <title>|</title>
		
		item_link = TEXT
		item_link.wrap = <link>|</link>
		
		item_description = TEXT
		item_description.wrap = <description>|</description>
		
		item_author = 
		
		# Assumed here that all articles will be categorized the same as the channel
		item_category < .channel_category
		
		item_comments =  
		
		item_enclosure = TEXT
		item_enclosure {
			value = <enclosure url="{field:enclosure_url}" length="{field:size}" type="{field:mime_type}" />
			insertData = 1
		}
		
		item_pubdate = TEXT
		item_pubdate.strftime = %a, %d %b %Y, %I:%M:%S %z
		item_pubdate.wrap = <pubDate>|</pubDate>

		
		item_guid = TEXT
		item_guid.wrap = <guid>|</guid>
		
		item_source = TEXT
		item_source.dataWrap = <source url="{field:item_link}">|</source>
		
	}
	
	rss2 = PAGE
	rss2.config {
		disableAllHeaderCode = 1
		additionalHeaders = Content-type:application/xml
		xhtml_cleaning = 0
		admPanel = 0
	}

	rss2.10 < plugin.tx_wecapi_list
	rss2.10.version = rss2
	rss2.10.CMD = xml


}

